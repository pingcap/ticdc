Running unit tests...
âœ–  pkg/sink/iceberg (3.357s)

=== Failed
=== FAIL: pkg/sink/iceberg TestAppendChangelogPartitionsByCommitTimeDay (0.06s)
[2026/02/01 22:18:04.705 +08:00] [INFO] [local.go:82] ["failed to write file, try to mkdir the path"] [path=/var/folders/q9/xy1cmtms3c94t19c90xksc3w0000gn/T/TestAppendChangelogPartitionsByCommitTimeDay1047279214/001/ns/test/table1/data]
[2026/02/01 22:18:04.732 +08:00] [INFO] [local.go:82] ["failed to write file, try to mkdir the path"] [path=/var/folders/q9/xy1cmtms3c94t19c90xksc3w0000gn/T/TestAppendChangelogPartitionsByCommitTimeDay1047279214/001/ns/test/table1/metadata]
    partitioning_test.go:113:
        	Error Trace:	/Users/brian.w/projects/ticdc/pkg/sink/iceberg/partitioning_test.go:113
        	Error:      	"[map[added_snapshot_id:1769955484680 content:0 manifest_length:1849 manifest_path:file:///var/folders/q9/xy1cmtms3c94t19c90xksc3w0000gn/T/TestAppendChangelogPartitionsByCommitTimeDay1047279214/001/ns/test/table1/metadata/manifest-7d5153d2-1d56-4d38-866c-f22447d33aae.avro min_sequence_number:1 partition_spec_id:0 sequence_number:1]]" should have 2 item(s), but has 1
        	Test:       	TestAppendChangelogPartitionsByCommitTimeDay

=== FAIL: pkg/sink/iceberg TestUpsertPartitionsDeletesWhenDerivedFromEqualityFields (unknown)
fatal error: checkptr: pointer arithmetic result points to invalid allocation

goroutine 78 gp=0xc0010f6380 m=8 mp=0xc000500008 [running]:
runtime.throw({0x10b1d227e?, 0xc001217110?})
	/usr/local/go/src/runtime/panic.go:1094 +0x34 fp=0xc000e6e720 sp=0xc000e6e6f0 pc=0x104b308e4
runtime.checkptrArithmetic(0xc000e6e768?, {0x0, 0x0, 0x104b3b438?})
	/usr/local/go/src/runtime/checkptr.go:69 +0xa8 fp=0xc000e6e750 sp=0xc000e6e720 pc=0x104ac0e18
github.com/spaolacci/murmur3.Sum32WithSeed({0xc00082811c, 0x4, 0x4}, 0x0)
	/Users/brian.w/go/pkg/mod/github.com/spaolacci/murmur3@v1.1.0/murmur32.go:129 +0x80 fp=0xc000e6e7c0 sp=0xc000e6e750 pc=0x107d2b540
github.com/spaolacci/murmur3.Sum32(...)
	/Users/brian.w/go/pkg/mod/github.com/spaolacci/murmur3@v1.1.0/murmur32.go:111
github.com/pingcap/ticdc/pkg/sink/iceberg.computePartitionValue({{0xc0008280a0, 0xc}, 0x3e8, {0xc000175ff7, 0x2}, 0x1, {0x10b03df6d, 0x3}, {0xc000828086, 0xa}, ...}, ...)
	/Users/brian.w/projects/ticdc/pkg/sink/iceberg/partitioning.go:507 +0x1ba8 fp=0xc000e6eaf0 sp=0xc000e6e7c0 pc=0x10aeb74b8
github.com/pingcap/ticdc/pkg/sink/iceberg.(*resolvedPartitionSpec).groupRows(0xc0007c8c40, {0xc000a21900, 0x1, 0x1})
	/Users/brian.w/projects/ticdc/pkg/sink/iceberg/partitioning.go:373 +0xa78 fp=0xc000e6f130 sp=0xc000e6eaf0 pc=0x10aeb5188
github.com/pingcap/ticdc/pkg/sink/iceberg.(*TableWriter).Upsert(0xc000c07a20, {0x10d13a988, 0x112ba7f88}, {{0xf14c73376812ab20, 0x3802d11f311439a4}, {{0x10b03d7d6, 0x2}, {0x10b04cf1a, 0x7}}}, 0xc0003790a0, ...)
	/Users/brian.w/projects/ticdc/pkg/sink/iceberg/upsert_table.go:92 +0x8dc fp=0xc000e6f8d0 sp=0xc000e6f130 pc=0x10aebf1bc
github.com/pingcap/ticdc/pkg/sink/iceberg.TestUpsertPartitionsDeletesWhenDerivedFromEqualityFields(0xc000fc68c0)
	/Users/brian.w/projects/ticdc/pkg/sink/iceberg/partitioning_test.go:283 +0xe88 fp=0xc000e6fec0 sp=0xc000e6f8d0 pc=0x10aecc7e8
testing.tRunner(0xc000fc68c0, 0x10d0afda0)
	/usr/local/go/src/testing/testing.go:1934 +0x168 fp=0xc000e6ffa0 sp=0xc000e6fec0 pc=0x104d12f28
testing.(*T).Run.gowrap1()
	/usr/local/go/src/testing/testing.go:1997 +0x40 fp=0xc000e6ffd0 sp=0xc000e6ffa0 pc=0x104d14480
runtime.goexit({})
	/usr/local/go/src/runtime/asm_arm64.s:1268 +0x4 fp=0xc000e6ffd0 sp=0xc000e6ffd0 pc=0x104b3a294
created by testing.(*T).Run in goroutine 1
	/usr/local/go/src/testing/testing.go:1997 +0x6e4
